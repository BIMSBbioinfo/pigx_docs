
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>PiGx scRNA-seq Â· GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="gitbook/images/favicon.ico" type="image/x-icon">

    
    
    <link rel="prev" href="pigx-bs-seq.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="./">
            
                <a href="./">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="pigx-rna-seq.html">
            
                <a href="pigx-rna-seq.html">
            
                    
                    PiGx RNA-seq
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="pigx-chip-seq.html">
            
                <a href="pigx-chip-seq.html">
            
                    
                    PiGx ChIP-seq
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="pigx-bs-seq.html">
            
                <a href="pigx-bs-seq.html">
            
                    
                    PiGx BS-seq
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.5" data-path="pigx-scrna-seq.html">
            
                <a href="pigx-scrna-seq.html">
            
                    
                    PiGx scRNA-seq
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="." >PiGx scRNA-seq</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="pigx-pipeline-for-single-cell-rnaseq">pigx pipeline for single-cell RNAseq</h1>
<p><a name="logo"></a></p>
<div align="center">
<img src="images/Logo_PiGx.png" alt="PiGx Logo" width="30%" height="30%">

</div>

<p><strong>Copyright 2017-2018: Vedran Franke, Bora Uyar, Ricardo Wurmus, Altuna Akalin.</strong>
<strong>This work is distributed under the terms of the GNU General Public License, version 3 or later.  It is free to use for all purposes.</strong></p>
<hr>
<h2 id="summary">Summary</h2>
<p>PiGX scRNAseq is an analysis pipeline for preprocessing and quality control for single cell RNA sequencing experiments. 
The inputs are read files from the sequencing experiment, and a configuration file which describes the experiment. 
It produces processed files for downstream analysis and interactive quality reports. 
The pipeline is designed to work with UMI based methods. It currently supports all methods which output paired
adapter - read files.</p>
<h2 id="what-does-it-do">What does it do</h2>
<ul>
<li>Quality control reads using fastQC and multiQC</li>
<li>Automatically determines the appropriate cell number</li>
<li>Constructs the digital gene expression matrix</li>
<li>Calculates per sample and per cell statistics</li>
<li>Prepares a quality control report</li>
<li>Normalizes data and does dimensionallity reduction</li>
</ul>
<h2 id="what-does-it-output">What does it output</h2>
<ul>
<li>bam files</li>
<li>bigwig files</li>
<li>UMI and read count matrices</li>
<li>Quality control report</li>
<li>SingleCellExperiment object with pre-calculated statistics and dimensionallity reductions</li>
</ul>
<h1 id="install">Install</h1>
<p>At this time there are no ready-made packages for this pipeline, so
you need to install PiGx from source.</p>
<p>You can find the <a href="https://github.com/BIMSBbioinfo/pigx_scrnaseq/releases/latest" target="_blank">latest
release</a>
here.  PiGx uses the GNU build system.  Please make sure that all
required dependencies are installed and then follow these steps after
unpacking the latest release tarball:</p>
<pre><code class="lang-sh">./configure --prefix=/some/<span class="hljs-built_in">where</span>
make install
</code></pre>
<h1 id="dependencies">Dependencies</h1>
<p>By default the <code>configure</code> script expects tools to be in a directory
listed in the <code>PATH</code> environment variable.  If the tools are installed
in a location that is not on the <code>PATH</code> you can tell the <code>configure</code>
script about them with variables.  Run <code>./configure --help</code> for a list
of all variables and options.</p>
<p>You can prepare a suitable environment with Conda or with <a href="https://gnu.org/s/guix" target="_blank">GNU
Guix</a>.  </p>
<h2 id="via-conda">Via Conda</h2>
<ul>
<li>Download pigx_scrnaseq source code <ul>
<li>run: <blockquote>
<p>git clone <a href="https://github.com/BIMSBbioinfo/pigx_scrnaseq.git" target="_blank">https://github.com/BIMSBbioinfo/pigx_scrnaseq.git</a></p>
</blockquote>
</li>
</ul>
</li>
<li>Download and install Anaconda from <a href="https://www.anaconda.com/download" target="_blank">https://www.anaconda.com/download</a></li>
<li>Locate the &apos;environment.yml&apos; file in the source code. <ul>
<li>run:<blockquote>
<p>conda env create -f environment.yml #provide path to the environment.yml file</p>
</blockquote>
</li>
<li>activate the environment:<blockquote>
<p>source activate pigx_scrnaseq </p>
</blockquote>
</li>
</ul>
</li>
</ul>
<h2 id="via-guix">Via Guix</h2>
<p>Assuming you have Guix installed, the following command spawns a
sub-shell in which all dependencies are available:</p>
<pre><code class="lang-sh">guix environment <span class="hljs-_">-l</span> guix.scm
</code></pre>
<p>If you do not use one of these package
managers, you will need to ensure that the following software is
installed:</p>
<details>
<summary>Software dependencies</summary>

</details>

<h1 id="getting-started">Getting started</h1>
<p>To run PiGx on your experimental data, first enter the necessary parameters in the spreadsheet file (see following section), and then from the terminal type.
To run the pipeline, you will also need the appropriate genome sequence in fasta format, and the genome annotation in a 
gtf format.</p>
<pre><code class="lang-sh">$ pigx-rscnaseq [options] sample_sheet.csv <span class="hljs-_">-s</span> settings.yaml
</code></pre>
<p>To see all available options type the <code>--help</code> option</p>
<pre><code class="lang-sh">$ pigx-scrnaseq --help

usage: pigx-scrnaseq [-h] [-v] <span class="hljs-_">-s</span> SETTINGS [-c CONFIGFILE] [--target TARGET]
                   [-n] [--graph GRAPH] [--force] [--reason] [--unlock]
                   samplesheet

PiGx scRNAseq Pipeline.

PiGx scRNAseq is a data processing pipeline <span class="hljs-keyword">for</span> single cell RNAseq <span class="hljs-built_in">read</span> data.

positional arguments:
  samplesheet                             The sample sheet containing sample data <span class="hljs-keyword">in</span> CSV format.

optional arguments:
  -h, --help                              show this <span class="hljs-built_in">help</span> message and <span class="hljs-built_in">exit</span>
  -v, --version                           show program<span class="hljs-string">&apos;s version number and exit
  -s SETTINGS, --settings SETTINGS        A YAML file for settings that deviate from the defaults.
  -c CONFIGFILE, --configfile CONFIGFILE  The config file used for calling the underlying snakemake process.  By
                                          default the file &apos;</span>config.json<span class="hljs-string">&apos; is dynamically created from the sample
                                          sheet and the settings file.
  --target TARGET                         Stop when the named target is completed instead of running the whole
                                          pipeline.  The default target is &quot;final-report&quot;.  Pass &quot;--target=help&quot;
                                          to describe all available targets.
  -n, --dry-run                           Only show what work would be performed.  Do not actually run the
                                          pipeline.
  --graph GRAPH                           Output a graph in Graphviz dot format showing the relations between
                                          rules of this pipeline.  You must specify a graph file name such as
                                          &quot;graph.pdf&quot;.
  --force                                 Force the execution of rules, even though the outputs are considered
                                          fresh.
  --reason                                Print the reason why a rule is executed.
  --unlock                                Recover after a snakemake crash.

This pipeline was developed by the Akalin group at MDC in Berlin in 2017-2018.
</span></code></pre>
<h1 id="the-input-parameters">The input parameters</h1>
<h2 id="sample-sheet">Sample Sheet</h2>
<p>The sample sheet is a tabular file describing the experiment. The table has the following columns:</p>
<table>
<thead>
<tr>
<th>name</th>
<th>reads1</th>
<th>reads2</th>
<th>library</th>
<th>covariate1</th>
<th>covariate2</th>
</tr>
</thead>
<tbody>
<tr>
<td></td>
</tr>
</tbody>
</table>
<ul>
<li><em>name</em> - name for the sample, which will be used to label the sample in all downstream analysis</li>
<li><em>reads1</em> - fastq file containing the <strong>adapter sequences</strong></li>
<li><em>reads2</em> - fastq file containing the <strong>sequenced reads</strong><ul>
<li>location of these files is specified in <code>settings.yaml</code></li>
</ul>
</li>
<li><em>library</em> - sequencing platform on which the experiment was performed (i.e. dropseq)</li>
<li><em>covariates</em> - variables which describe the samples</li>
</ul>
<p>Additional columns may be included which may be used as covariates in the differential expression analysis (sex, age, different treatments).</p>
<h2 id="settings-file">Settings File</h2>
<p>The settings file is a <em>YAML</em> file which specifies:</p>
<ul>
<li>Locations:<ul>
<li>The locations of the reads (directory where <code>fastq</code> files are located)</li>
<li>The location of the output directory</li>
<li>The location of the <code>fasta</code> file with the reference genome (must be prepared by the user)</li>
<li>The location of a <code>GTF</code> file with genome annotations</li>
</ul>
</li>
<li>Organism name</li>
</ul>
<p>In order to get started, enter <code>pigx-scrnaseq --init-settings my_settings.yaml</code>. This will create a file called <code>my_settings.yaml</code> with the default structure. The file will look like this:</p>
<pre><code>locations:
  output-dir: out/
  reads-dir: sample_data/reads/
  tempdir:

annotation:
  primary:
    genome:
      name: hg19
      fasta: sample_data/genome.fa
    gtf: sample_data/genome.gtf

execution:
  submit-to-cluster: no
  jobs: 6
  nice: 19
</code></pre><h1 id="resource-consideration">Resource consideration</h1>
<p>Single cell expression analysis is data intensive, and requires substantial computing resources. 
The pipeline uses the <a href="https://github.com/alexdobin/STAR" target="_blank">STAR</a> aligner for read mapping, so the memory requirements will scale with the 
size of the genome. 
Please look at the <a href="https://github.com/alexdobin/STAR" target="_blank">STAR</a> manual for the concrete number about the memory requirements.
For the human/mouse genome it requires ~ 40Gb of RAM. 
The pipeline produces temporary files which require a substantial amount of disk space. Please ensure
that you have at least 30Gb of disk space per 100 milion sequenced reads.
The location of the temporary directory can be controlled using the tempdir: variable in the settings.yaml.
By default the tempdir is set to <strong>/tmp</strong>.</p>
<p><strong>Important:</strong> please make sure that the temporary directory has adequate free space</p>
<h1 id="output-structure-description">Output structure description</h1>
<h1 id="detailed-pipeline-description">Detailed pipeline description</h1>
<h1 id="downstream-analysis">Downstream analysis</h1>
<h3 id="cluster-execution">Cluster Execution</h3>
<p>The <code>execution</code> section in the settings file allows the user to specify whether the pipeline is to be submitted to a cluster, or run locally, and the degree of parallelism. For a full list of possible parameters, see <code>etc/settings.yaml</code>.</p>
<h1 id="example">Example</h1>
<p>An example can be found in the <code>tests</code> directory.  The
<code>sample_sheet.csv</code> file here specifies the following sample data:</p>
<hr>
<p>2018</p>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="pigx-bs-seq.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page: PiGx BS-seq">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"PiGx scRNA-seq","level":"1.5","depth":1,"previous":{"title":"PiGx BS-seq","level":"1.4","depth":1,"path":"pigx-bs-seq.md","ref":"pigx-bs-seq.md","articles":[]},"dir":"ltr"},"config":{"gitbook":"*","theme":"default","variables":{},"plugins":[],"pluginsConfig":{"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"}},"file":{"path":"pigx-scrna-seq.md","mtime":"2018-03-08T08:22:01.983Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2018-03-08T08:23:43.100Z"},"basePath":".","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="gitbook/gitbook.js"></script>
    <script src="gitbook/theme.js"></script>
    
        
        <script src="gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

